/*!
 * ====================================================
 * Hot Box UI - v0.1.0 - 2014-12-18
 * https://github.com/fex-team/hotbox
 * GitHub: https://github.com/fex-team/hotbox.git 
 * Copyright (c) 2014 Baidu FEX; Licensed BSD
 * ====================================================
 */

!function(){function a(a){b.r([c[a]])}var b={r:function(a){if(b[a].inited)return b[a].value;if("function"==typeof b[a].value){var c={exports:{}},d=b[a].value(null,c.exports,c);return b[a].inited=!0,b[a].value=d||c.exports}return b[a].inited=!0,b[a].value}};b[0]={value:function(a,c,d){d.exports=window.HotBox=b.r(1)}},b[1]={value:function(a,c,d){function e(a){return document.createElement(a)}function f(a,b){a.classList.add(b)}function g(a,b){a.classList.remove(b)}function h(a,b){a.appendChild(b)}function i(a,b){return"object"!=typeof b&&(b=[].slice.apply(arguments,1)),String(a).replace(/\{(\w+)\}/g,function(a,c){return b[c]||a})}function j(a){function b(){var b=new l(a);a.onmousedown=function(a){b.active(),a.preventDefault(),o!=m&&d(m)},g.onmousedown=function(a){a.stopPropagation(),a.preventDefault()},a.oncontextmenu=function(a){q.openOnContextMenu&&(a.preventDefault(),o==m&&(d("main",{x:a.offsetX,y:a.offsetY}),console.log(a)))},b.onkeydown=b.onkeyup=function(b){if(b.keydown&&q.activeKey&&b.isKey(q.activeKey)&&o==m&&j)return void d("main",{x:a.clientWidth/2,y:a.clientHeight/2});var c=o==m?j:o;c&&c.handleKeyEvent(b)}}function c(a){if(!a)return o;if(a==m)throw new Error("Can not define or use the `idle` state.");return i[a]=i[a]||new k(this,a),"main"==a&&(j=i[a]),i[a]}function d(a,b){if(a==m)o!=m&&(p.shift().deactive(),p=[]),o=m;else if("back"==a)o!=m&&(o.deactive(),p.shift(),o=p[0],o?o.active():o="idle");else{o!=m&&o.deactive();var c=i[a];p.unshift(c),c.active(b),o=c}}if("string"==typeof a&&(a=document.querySelector(a)),!(a&&a instanceof HTMLElement))throw new Error("No container or not invalid container for hot box");var g=e(n);f(g,"hotbox"),h(a,g),this.$element=g,this.$container=a;var i={},j=null,o=m,p=[],q=this;b(),this.state=c,this.active=d,this.activeKey="space",this.actionKey="space"}function k(a,b){function c(){function a(a){var b=z.ring,c=2*Math.PI/b.length;z.center&&(z.center.indexedPosition=[0,0]);for(var d,e,f,g,h=0;h<b.length;h++)d=b[h].$button,e=c*h-Math.PI/2,f=a*Math.cos(e),g=a*Math.sin(e),b[h].indexedPosition=[f,g],d.style.left=f+"px",d.style.top=g+"px"}function b(a){var b=-x.clientWidth/2,c=2*-a-x.clientHeight/2;x.style.marginLeft=b+"px",x.style.marginTop=c+"px",z.top.forEach(function(a){var d=a.$button;a.indexedPosition=[b+d.offsetLeft+d.clientWidth/2,c]})}function c(a){var b=-y.clientWidth/2,c=2*a-y.clientHeight/2;y.style.marginLeft=b+"px",y.style.marginTop=c+"px",z.bottom.forEach(function(a){var d=a.$button;a.indexedPosition=[b+d.offsetLeft+d.clientWidth/2,c]})}function d(){function a(a){var c,d,e,f,g,h,i={},j=0,k={},l=a.indexedPosition,m=Math.abs;b.forEach(function(b){if(a!=b)for(c=b.indexedPosition,g=[],d=c[0]-l[0],e=c[1]-l[1],f=Math.sqrt(d*d+e*e),m(d)>2&&(g.push(d>0?"right":"left"),g.push(f+m(e))),m(e)>2&&(g.push(e>0?"down":"up"),g.push(f+m(d)));g.length;)h=g.shift(),j=g.shift(),(!i[h]||j<k[h])&&(i[h]=b,k[h]=j)}),a.neighbor=i}var b=A.filter(function(a){return a.indexedPosition});b.forEach(a)}var e=15*z.ring.length;a(e),b(e),c(e),d(),E=!1}function d(a){var b=e(n);f(b,"button");var c=a.render||j;switch(b.innerHTML=c(i,a),a.position){case"center":h(v,b);break;case"ring":h(w,b);break;case"top":h(x,b);break;case"bottom":h(y,b)}return{action:a.action,enable:a.enable,key:a.key,next:a.next,label:a.label,$button:b}}function j(a,b){return a('<span class="label">{label}</span><span class="key">{key}</span>',b)}function k(b){b=b||{x:a.$container.clientWidth/2,y:a.$container.clientHeight/2},b&&(u.style.left=b.x+"px",u.style.top=b.y+"px"),f(u,t),E&&c(),B||p(z.center||z.ring[0]||z.top[0]||z.bottom[0]),D=!0}function l(){g(u,t),p(null),D=!1}function o(a){C&&C.$button&&g(C.$button,s),C=a,C&&C.$button&&f(C.$button,s)}function p(a){B&&B.$button&&B.$button&&g(B.$button,r),B=a,B&&B.$button&&f(B.$button,r)}function q(b){b&&((!b.enable||b.enable())&&(b.action&&b.action(),a.active(b.next||m)),o(null),p(null))}var r="selected",s="pressed",t="active",u=e(n),v=e(n),w=e(n),x=e(n),y=e(n);f(u,"state"),f(u,b),f(v,"center"),f(w,"ring"),f(x,"top"),f(y,"bottom"),h(a.$element,u),h(u,v),h(u,w),h(u,x),h(u,y),this.name=b;var z={center:null,ring:[],top:[],bottom:[],behind:[]},A=[],B=null,C=null,D=!1,E=!0;this.button=function(a){var b=d(a);"center"==a.position?z.center=b:z[a.position]&&z[a.position].push(b),A.push(b),E=!0},this.active=k,this.deactive=l,u.onmouseup=function(a){if(!a.button)for(var b=a.target;b&&b!=u;)b.classList.contains("button")&&A.forEach(function(a){a.$button==b&&q(a)}),b=b.parentNode},this.handleKeyEvent=function(c){if(c.keydown){if(A.forEach(function(d){c.isKey(d.key)&&(p(d),o(d),c.preventDefault(),c.stopPropagation(),!D&&a.hintDeactiveMainState&&a.active(b))}),c.isKey("esc"))return void(C?c.isKey(C.key)||o(null):a.active("back"));["up","down","left","right"].forEach(function(a){if(c.isKey(a)){if(!B)return void p(z.center||z.ring[0]||z.top[0]||z.bottom[0]);var b=B.neighbor[a];b&&p(b)}}),c.isKey("space")&&B?o(B):C&&C!=B&&o(null)}else c.keyup&&C&&(c.isKey("space")&&B==C||c.isKey(C.key))&&(q(C),c.preventDefault(),c.stopPropagation())}}var l=(b.r(2),b.r(3)),m="idle",n="div";d.exports=j}},b[2]={value:function(a,c){function d(a){return"string"==typeof a?f(a):e(a)}function e(a){var b=0;return(a.ctrlKey||a.metaKey)&&(b|=h),a.altKey&&(b|=i),a.shiftKey&&(b|=j),b|=a.keyCode}function f(a){var b=0;return a.toLowerCase().split(/\s*\+\s*/).forEach(function(a){switch(a){case"ctrl":case"cmd":b|=h;break;case"alt":b|=i;break;case"shift":b|=j;break;default:b|=g[a]}}),b}var g=b.r(4),h=4096,i=8192,j=16384;c.hash=d}},b[3]={value:function(a,c,d){function e(a){function b(){j=document.createElement("input"),j.classList.add(h),j.onkeyup=c,j.onkeypress=c,j.onkeydown=c,j.onfocus=d,j.onblur=e,j.oninput=function(){j.value=null},a.appendChild(j),d()}function c(a){if(i){var b=a.type.toLowerCase(),c=k["on"+b];c&&(a.keyHash=f.hash(a),a.isKey=function(b){return a.keyHash==f.hash(b)},a[b]=!0,c(a))}}function d(){j.select(),j.focus(),i=!0,a.classList.add(g)}function e(){j.blur(),i=!1,a.classList.remove(g)}var i=!0,j=null,k=this;b(),this.active=d,this.deactive=e}var f=b.r(2),g="hotbox-focus",h="hotbox-key-receiver";d.exports=e}},b[4]={value:function(a,b,c){var d={Shift:16,Control:17,Alt:18,CapsLock:20,BackSpace:8,Tab:9,Enter:13,Esc:27,Space:32,PageUp:33,PageDown:34,End:35,Home:36,Insert:45,Left:37,Up:38,Right:39,Down:40,Direction:{37:1,38:1,39:1,40:1},Del:46,NumLock:144,Cmd:91,CmdFF:224,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,"`":192,"=":187,"-":189,"/":191,".":190};for(var e in d)d.hasOwnProperty(e)&&(d[e.toLowerCase()]=d[e]);var f=65,g="a".charCodeAt(0);"abcdefghijklmnopqrstuvwxyz".split("").forEach(function(a){d[a]=f+(a.charCodeAt(0)-g)});var h=9;do d[h.toString()]=h+48;while(--h);c.exports=d}};var c={expose:0};a("expose")}();